services:
  # Service Web (Backend Spring Boot)
  - type: web
    name: fieldtrack-backend
    env: java
    region: frankfurt
    plan: free
    buildCommand: chmod +x backend/render-build.sh && backend/render-build.sh
    startCommand: chmod +x backend/render-start.sh && backend/render-start.sh
    envVars:
      # Base de données PostgreSQL (sera remplacé par les variables de la base de données)
      - key: SPRING_DATASOURCE_URL
        fromDatabase:
          name: fieldtrack-db
          property: connectionString
      - key: SPRING_DATASOURCE_USERNAME
        fromDatabase:
          name: fieldtrack-db
          property: user
      - key: SPRING_DATASOURCE_PASSWORD
        fromDatabase:
          name: fieldtrack-db
          property: password
      # Configuration de l'application
      - key: SPRING_PROFILES_ACTIVE
        value: prod
      # JWT Secret (à changer en production)
      - key: JWT_SECRET_KEY
        generateValue: true
      # URLs client (à adapter selon votre frontend déployé)
      - key: CLIENT_BASE_URL_ONLINE
        value: https://votre-frontend.vercel.app
      - key: CLIENT_BASE_URL_LOCAL
        value: http://localhost:4200
      - key: CLIENT_BASE_URL_FLUTTER
        value: http://localhost:4300

  # Base de données PostgreSQL
  - type: pg
    name: fieldtrack-db
    databaseName: fieldtrack
    user: fieldtrack_user
    plan: free
    region: frankfurt
